<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/styles.css">
    <title>PÃ¡gina de Rifa</title>
    <style>
        /* Estilo para nÃºmeros selecionÃ¡veis */
        .numero-selecionavel {
            cursor: pointer;
        }
        .numero-selecionavel.selected {
            background-color: orange;
        }
    </style>
</head>
<body>
<header class="header">
    <nav class="navbar">
        <div class="logo">
            <a href="#"><img src="/images/logo.png" alt="Logo"></a>
        </div>
        <div class="menu">
            <a href="index">InÃ­cio</a>
        </div>
        <div class="search">
            <input type="text" placeholder="Digite o nÃºmero do celular">
            <button class="text-xs font-medium sm:text-base flex-none border bg-white max-w-max border-Black-100 rounded-lg px-3 py-1"> ðŸ”Ž Buscar bilhetes </button>
        </div>
    </nav>
</header>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<div class="rifa-selection">
    <p><b>ðŸ”ŽSelecione uma rifa</b></p>
    <hr>
    <select id="rifasSelect">
        <option value="">Selecione uma rifa</option>
        <!-- Usando Thymeleaf para iterar sobre os cÃ³digos de rifa e criar as opÃ§Ãµes -->
        <option th:each="codigoRifa : ${codigosRifa}" th:value="${codigoRifa}" th:text="${codigoRifa}"></option>
    </select>
</div>

<br>
<br>
<br>

<div class="main-section">
    <div class="left-column">

        <p class="rifa-title">DescriÃ§Ã£o da Rifa</p>

        <div class="prize-rectangle">
            <div class="prize-image">
                <img src="/images/premio.png" alt="PrÃªmio">
            </div>
        </div>
    </div>

    <div class="right-column">
        <!-- TrÃªs retÃ¢ngulos para informaÃ§Ãµes -->
        <div class="info-rectangle-1">
            <p>PreÃ§o da Rifa</p>
            <p th:text="${rifa.preco}"></p>
        </div>

        <div class="info-rectangle-2">
            <p>Sorteio: Loteria Federal</p>
        </div>

        <div class="info-rectangle-3">
            <p>PrÃªmio</p>
            <p th:text="${rifa.premio}"></p>
        </div>
    </div>
</div>

<br>
<br>
<br>

<div class="description-column" style="text-align: justify;">
    <p><b>ðŸ“•Regulamento / DescriÃ§Ã£o</b></p>
    <hr>
    <p th:text="${rifa.regulamento}"></p>
</div>

<h1 class="centered-title">Escolha um nÃºmero</h1>

<table>
    <tbody id="numero-matrix">
    <!-- Os nÃºmeros serÃ£o preenchidos dinamicamente aqui usando JavaScript -->
    </tbody>
</table>

<script>
    // JavaScript em rifa.html
 document.addEventListener("DOMContentLoaded", function () {
     const rifaSelect = document.getElementById("rifasSelect");

     // FunÃ§Ã£o para criar e preencher a matriz de nÃºmeros
     function createNumberMatrix() {
         const numeroMatrix = document.getElementById('numero-matrix');
         let numero = 1;
         for (let row = 0; row < 10; row++) {
             const newRow = document.createElement('tr');
             for (let col = 0; col < 15; col++) {
                 const newCell = document.createElement('td');
                 newCell.textContent = numero;
                 newCell.classList.add("numero-selecionavel"); // Adicione a classe "numero-selecionavel" aos nÃºmeros
                 newRow.appendChild(newCell);
                 numero++;
             }
             numeroMatrix.appendChild(newRow);
         }
     }

     // Adicione um ouvinte de evento de clique a todas as cÃ©lulas da tabela
     const numeroMatrix = document.getElementById('numero-matrix');
     numeroMatrix.addEventListener("click", function (event) {
         const numeroSelecionavel = event.target;

         // Verifique se o elemento clicado possui a classe "numero-selecionavel"
         if (numeroSelecionavel.classList.contains("numero-selecionavel")) {
             // Alternar a classe "selected" quando uma cÃ©lula Ã© clicada
             numeroSelecionavel.classList.toggle("selected");
         }
     });

     // Chame a funÃ§Ã£o para gerar a matriz de nÃºmeros quando a pÃ¡gina for carregada
     createNumberMatrix();

     // Verifique se hÃ¡ um parÃ¢metro 'id_rifa' na URL e defina o valor selecionado no combobox
     const urlParams = new URLSearchParams(window.location.search);
     const idRifa = urlParams.get("id_rifa");
     if (idRifa) {
         rifaSelect.value = idRifa;
     }

     // Adicione um ouvinte de evento ao combobox
     rifaSelect.addEventListener("change", function () {
         // ObtÃ©m o valor selecionado (o cÃ³digo da rifa)
         const selectedRifa = rifaSelect.value;

         // Atualiza a URL da pÃ¡gina com o novo valor selecionado
         const currentUrl = window.location.href;
         const newUrl = updateQueryStringParameter(currentUrl, 'id_rifa', selectedRifa);
         window.location.href = newUrl;
     });
 });

 // FunÃ§Ã£o auxiliar para atualizar parÃ¢metros de consulta na URL
 function updateQueryStringParameter(uri, key, value) {
     const re = new RegExp("([?&])" + key + "=.*?(&|$)", "i");
     const separator = uri.indexOf('?') !== -1 ? "&" : "?";
     if (uri.match(re)) {
         return uri.replace(re, '$1' + key + "=" + value + '$2');
     }
     else {
         return uri + separator + key + "=" + value;
     }
 }

</script>

<h1 class="centered-title">ðŸ’³ðŸ’° Formas de pagamentos</h1>
<div class="pix-rectangle">
    <div class="pix-image">
        <img src="/images/pix.png" alt="Pix">
    </div>
</div>

<br>
<br>
<br>

<div class="footer">
    <p>&copy; 2023 - Sistema de Financiamento Coletivo - Todos os direitos reservados</p>
</div>
</body>
</html>
